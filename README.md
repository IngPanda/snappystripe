# WalletStripe

### Description

php component to connect applications with stripe


### Installation / Usage



#### 1. Use Composer

``` bash
$ composer require suseche/walletstripe
```
#### 2. Run the migration command


``` bash
$ php artisan migrate 
```
#### 3. Create Account in Stripe 

[https://stripe.com//](https://stripe.com/)

In the dashboard options go to:

* Developers
	* API Keys

Copy the Secret key provided by stripe and in the laravel environment file add the following:

	-STRIPE_KEY (Secret key from stripe)
	-APP_ENV
	-APP_NAME


### Requirements

- PHP 7.1.3
- Laravel 5.6



### Usage

``` php

namespace App\Http\Controllers;


use suseche\walletstripe\WalletStripe;

class UserController extends Controller
{
    public function createCustomer(Request $request)
    {
    	$wallet = new WalletStripe;
    	$customer = $wallet->createConstumer($user->id);
    }
}

```


### Methods

* __createConstumer__

``` php
$wallet = new WalletStripe;
$customer = $wallet->createConstumer($user->id);
```

1. __params__

	_account_id_: Account's local identifier which you want to link the customer stripe to.

1. __return__ 

	All customer data stored in Stripe

* __getCostumerId__

``` php
$wallet = new WalletStripe;
$customer = $wallet->getCostumerId($user->id);
```

1. __params__

	- _account_id_: Local identifier of the account.

1. __return__ 
	
	- The customer identifier in stripe


* __getDataCustomer__

``` php
$wallet = new WalletStripe;
$customer = $wallet->getDataCustomer($user->id);
```

1. __params__

	- account_id: Local identifier of the account.

1. return 
	
	- All customer data stored in stripe


* __createCreditCard__

``` php
$wallet = new WalletStripe;
$customer = $wallet->createCreditCard($user->id,$token_card);
```

1. __params__

	- account_id: Local identifier of the account.
	- $token: Token generated by the front end of stripe using the public key.

1. __return__ 
	
	- All credit card data stored in stripe

* __getCreditCards__

``` php
$wallet = new WalletStripe;
$customer = $wallet->getCreditCards($user->id,$card_id);
```

1. __params__
	- account_id: Local identifier of the account.
	- $card_id: (optional) identifier of the credit card in stripe, if the value is not sent the function returns a list of the credit cards

1. __return__ 
	
	- all credit card data stored in stripe / list credit cards

* __deleteCreditCard__

``` php
$wallet = new WalletStripe;
$customer = $wallet->deleteCreditCard($user->id,$card_id);
```

1. __params__

	- account_id: Local identifier of the account.
	- $card_id: identifier of the credit card in stripe

1. __return__ 
	
	- Boolean response of the operation


* __updateCreditCard__

``` php
$wallet = new WalletStripe;
$customer = $wallet->updateCreditCard($user->id,$card_id,[
    'name'          => 'John Doe',
    'address_line1' => 'Example Street 1',
    ]);
```

1. __params__

	- account_id: Local identifier of the account.
	- $card_id: Identifier of the credit card in stripe
	- $data:  Array with a single data that can be modified from a credit card

``` php
$data = [
    'name'          => 'John Doe',
    'address_line1' => 'Example Street 1',
    'address_line2' => 'Example Street 2',
    'address_state' => 'Texas',
    'address_zip' 	=> '55555',
    'exp_month' 	=> '03',
    'exp_year' 	    => '2025',
    ]
```

2. __return__ 

	- all credit card data stored in stripe


* __generateTokenCreditCard__

_Note: this method should only be used for testing purposes since its use in production may result in misuse of data that is sensitive and vulnerable to scams or fraud_

``` php
$wallet = new WalletStripe;
$customer = $wallet->generateTokenCreditCard($user->id,[
    'number'    => '4242424242424242',
    'exp_month' => 10,
    'cvc'       => 314,
    'exp_year'  => 2020,
    ]);
```

1. __params__	

	- account_id: Local identifier of the account.
	- $data:  array with credit card data

	_Note: if the array is not sent within the function a test token with test data is created_

``` php
$data =[
    'number'    => '4242424242424242',
    'exp_month' => 10,
    'cvc'       => 314,
    'exp_year'  => 2020,
    ]
```

2. __return__ 
	
	- token credit card

* __loadCharge__

``` php
$wallet = new WalletStripe;
$customer = $wallet->loadCharge($account_id,$amount,$description,$metadata,$currency)
```

1. __params__

	- account_id: Local identifier of the account.
	- $amount:  Amount of the charge
	- $description: Description of the charge
	- $metadata: Array with additional caharge data
	- $currency: A string representing the currency in ISO format (Default value if not sent is USD)

1. __return__ 
	
	- all charge data stored in stripe

